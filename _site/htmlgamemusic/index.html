<!DOCTYPE html> <html lang="en-US"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="Janessa Tran" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="Janessa Tran" /> <title> Adding Music to the Game - Janessa Tran </title> <link rel="alternate" href="http://localhost:4000/htmlgamemusic/" hreflang="en-US" /> <link rel="canonical" href="http://localhost:4000/htmlgamemusic/" /> <meta name="description" content="Full-stack software engineer" /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="Adding Music to the Game | " /> <meta property="og:title" content="Adding Music to the Game | " /> <meta property="og:type" content="website" /> <meta property="og:url" content="http://localhost:4000/htmlgamemusic/" /> <meta property="og:description" content="Full-stack software engineer" /> <meta property="og:image" content="http://localhost:4000/assets/img/me.png" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="Adding Music to the Game | janessatran_" /> <meta name="twitter:url" content="http://localhost:4000/htmlgamemusic/" /> <meta name="twitter:site" content="@janessatran_" /> <meta name="twitter:creator" content="@janessatran_" /> <meta name="twitter:description" content="Full-stack software engineer" /> <meta name="twitter:image" content="http://localhost:4000/assets/img/me.png" /> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Janessa Tran" /> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png" /> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> </head> <body data-theme="dark" class="notransition"> <script> const body = document.body; const data = body.getAttribute("data-theme"); const initTheme = (state) => { if (state === "dark") { body.setAttribute("data-theme", "dark"); } else if (state === "light") { body.removeAttribute("data-theme"); } else { localStorage.setItem("theme", data); } }; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512"> <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512"> <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512"> <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">home</a><a class="menu-link" href="/archive/">archive</a><a class="menu-link" href="/projects/">projects</a><a class="menu-link rss" href="/feed.xml"> <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512" fill="#ED812E"> <title>RSS</title> <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z" /> <path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z" /> <path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z" /> </svg> </a> </div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <div class="tags"> <span itemprop="keywords"> <a class="tag" href="/tags/#game-dev">GAME DEV</a> </span> </div> <h1 class="header-title" itemprop="headline">Adding Music to the Game</h1> <div class="post-meta"> <time datetime="2021-01-12T00:00:00-08:00" itemprop="datePublished"> Jan 12, 2021 </time> <time hidden datetime="" itemprop="dateModified"> Jan 12, 2021 </time> <span hidden itemprop="publisher" itemtype="Person">Janessa Tran</span> <span hidden itemprop="image"></span> <span hidden itemprop="mainEntityOfPage"><p><em>This is the third post in my series on learning html game development. You can find the other posts <a href="/tags/#Game%20Dev">here</a>!</em></p> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <p><em>This is the third post in my series on learning html game development. You can find the other posts <a href="/tags/#Game%20Dev">here</a>!</em></p> <p>While I don’t play a lot of video games, video game music is honestly one of my favorite genres of music. I find it really great to work to (because it’s upbeat/not distracting) and I also think sometimes it can really complete a game. To no surprise, I was pretty excited about this next feature which involves adding background music to the different game states (these starts are menu, play, and win)! If you’d like to learn how I did it, continue reading!</p> <h2 id="getting-the-music"> <a href="#getting-the-music" class="anchor-head"></a> Getting the music </h2> <p>The first thing we need to do is obtain audio files which we can then load into the game. The website I used to download free audio is <a href="https://www.playonloop.com/">playonloop.com</a>. They have a section for royalty-free music and allow people to download free short versions of the audio. Once you download your audio files, move them into the development repo (I put mine under <code class="language-plaintext highlighter-rouge">/audio</code>) for easy access.</p> <h2 id="adding-the-music-to-our-game"> <a href="#adding-the-music-to-our-game" class="anchor-head"></a> Adding the music to our game </h2> <h3 id="menu-music"> <a href="#menu-music" class="anchor-head"></a> Menu Music </h3> <p>The first audio file we are going to add to our game is the one that plays while the player is on the menu page. We load our files, like our other assets, inside the <code class="language-plaintext highlighter-rouge">preload</code> method for each state class.</p> <p>Read in audio files in <code class="language-plaintext highlighter-rouge">preload</code> method:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">MenuState</span><span class="p">.</span><span class="nx">preload</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">audio</span><span class="p">(</span><span class="dl">'</span><span class="s1">music</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">audio/menu-music.wav</span><span class="dl">'</span><span class="p">)</span>
        <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div> <p>Then, in the <code class="language-plaintext highlighter-rouge">create</code> method, create the audio and play it. We set <code class="language-plaintext highlighter-rouge">this.music.loop</code> to true to enable the music to play continuously.</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">MenuState</span><span class="p">.</span><span class="nx">create</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">music</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">audio</span><span class="p">(</span><span class="dl">'</span><span class="s1">music</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">music</span><span class="p">.</span><span class="nx">loop</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">music</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>
  <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div> <p>Since the music is playing continuously, however, we want to ensure that we stop the music before we change states so that the music doesn’t overlap.</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">MenuState</span><span class="p">.</span><span class="nx">start</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="dl">'</span><span class="s1">play</span><span class="dl">'</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="p">{</span><span class="na">level</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">music</span><span class="p">.</span><span class="nx">pause</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="playing-music"> <a href="#playing-music" class="anchor-head"></a> Playing Music </h3> <p>Next, we set up the music that plays while the game is being played. I wanted to keep the music continuous playing regardless of the level, so I had to create a variable to check if the music was already playing since music gets added at each level. I set this up by creating a flag in <code class="language-plaintext highlighter-rouge">init()</code> to keep track if the background music is playing, and then pass along the value every time a new level is created.</p> <p>Set the variable:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">PlayState</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">bgMusicPlaying</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">bgMusicPlaying</span> <span class="o">||</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div> <p>Check if music is playing via our variable <code class="language-plaintext highlighter-rouge">this.bgMusicPlaying</code>, if not, play it and set the variable:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">PlayState</span><span class="p">.</span><span class="nx">_loadLevel</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">bgMusicPlaying</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">music</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">audio</span><span class="p">(</span><span class="dl">'</span><span class="s1">background</span><span class="dl">'</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">music</span><span class="p">.</span><span class="nx">loop</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">music</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">bgMusicPlaying</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Additionally, whenever we call restart (the hero dies, or the game advances to the next level), we pass <code class="language-plaintext highlighter-rouge">this.bgMusicPlaying</code> to ensure that we don’t add another layer of music if it’s already playing.</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">restart</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="p">{</span> <span class="na">level</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">level</span><span class="p">,</span> <span class="na">bgMusicPlaying</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">bgMusicPlaying</span><span class="p">});</span>
</code></pre></div></div> <p>Finally, when the game is over, we transition to the win state, so we want to ensure that the music stops playing before we move on. We do this by checking if the next level is the last level, and if it is, pause the music.</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">PlayState</span><span class="p">.</span><span class="nx">_nextLevel</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hero</span><span class="p">.</span><span class="nx">dying</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">restart</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="p">{</span> <span class="na">level</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">level</span><span class="p">,</span> <span class="na">bgMusicPlaying</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">bgMusicPlaying</span><span class="p">});</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">level</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="nx">LEVEL_COUNT</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">fade</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">music</span><span class="p">.</span><span class="nx">pause</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">restart</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="p">{</span> <span class="na">level</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="na">bgMusicPlaying</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">bgMusicPlaying</span><span class="p">});</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div> <h3 id="win-state-music"> <a href="#win-state-music" class="anchor-head"></a> Win State Music </h3> <p>Lastly, we add music to the game for when the player has finished the game. It involves the same steps we’ve already gone over, but repetition never hurts so I’ll state the steps again!</p> <p>Load the asset in <code class="language-plaintext highlighter-rouge">preload</code></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WinState</span><span class="p">.</span><span class="nx">preload</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">load</span><span class="p">.</span><span class="nx">audio</span><span class="p">(</span><span class="dl">'</span><span class="s1">music</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">audio/win-music.wav</span><span class="dl">'</span><span class="p">)</span>
        <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div> <p>Add the audio to the game in <code class="language-plaintext highlighter-rouge">create</code> and set it to play on loop</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WinState</span><span class="p">.</span><span class="nx">create</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">music</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">audio</span><span class="p">(</span><span class="dl">'</span><span class="s1">music</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">music</span><span class="p">.</span><span class="nx">loop</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">music</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>
        <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div> <p>Pause the music when moving to another state</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WinState</span><span class="p">.</span><span class="nx">restart</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">game</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="dl">'</span><span class="s1">menu</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">music</span><span class="p">.</span><span class="nx">pause</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div> <h2 id="summary"> <a href="#summary" class="anchor-head"></a> Summary </h2> <p>And there we have it! Each state in the game now has background music 😃 You can check it out yourself <a href="https://janessatran.github.io/html5game/">here</a>. If you have any suggestions or questions, feel free to reach out! Thanks for reading!</p> </div> </article> </main> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/htmlgamewinpageanimations/" > <div class="nav-arrow">Previous</div> <span class="post-title">Sprucing up the Win Screen</span> </a> <a class="post-nav-item post-nav-next" href="/htmlgamedevhighjump/"> <div class="nav-arrow">Next</div> <span class="post-title">Adding the Ability to High Jump</span> </a> </nav> <footer class="footer"> <a class="footer_item" href="/thanks">ack.</a> <!-- <a class="footer_item" href="/assets/resume.pdf" download>resume</a> --> <a class="footer_item" href="/feed.xml">rss</a> <span class="footer_item">&copy; 2023</span> <small class="footer_copyright"> <!-- Klisé Theme: https://github.com/piharpi/jekyll-klise --> <a href="https://github.com/piharpi/jekyll-klise" target="_blank" rel="noreferrer noopener" >klisé</a > theme on <a href="https://jekyllrb.com" target="_blank" rel="noreferrer noopener" >jekyll</a > </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> </div> </body> </html>
